---
import ArticleHeadline from "../../components/large/ArticleHeadline.astro";
import Toc from "../../components/large/Toc";
import Base from "../../layouts/Base.astro";
import { getCollection } from 'astro:content';

export const getStaticPaths = async () => {

  const articles = await getCollection("article");
  
  return articles.map((article) => ({
    params: { slug: article.slug }, 
    props: { article },
  }));

}

const { article } = Astro.props;
const { Content, headings } = await article.render();
---
<Base title={`${article.data.title} | ${import.meta.env.APP_NAME}`} 
      description={article.data.description ?? ""} 
      ogImage={new URL(`/thambnail/${article.slug}.png`, import.meta.env.APP_URL)}
>
  <div class="flex flex-col lg:flex-row lg:min-h-dvh">
    <article class="lg:pt-9 lg:w-3/4">
      <ArticleHeadline slug={article.slug} data={article.data} />
      <section class="lg:hidden">
        <Toc headings={headings} client:visible />
      </section>
      <Content />
    </article>
    <aside class="hidden lg:block sticky top-0 pt-9 w-1/4 bg-emerald">
      <Toc headings={headings} client:load />
    </aside>
  </div>
</Base>