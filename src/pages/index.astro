---
import ArticleCardsPanel from "../components/large/ArticleCardsPanel.astro";
import Base from "../layouts/Base.astro";
import { getCollection } from "astro:content";
import { AllowedRoutes } from "../route";
import CategoriesPanel from "../components/large/CategoriesPanel";
import TagCardsPanel from "../components/large/TagCardsPanel";
import { SiGithub, SiZenn, SiTwitter } from "solid-icons/si";
import { IoLogoRss } from "solid-icons/io";

const articles = await getCollection("article", ({ data }) => {
	return import.meta.env.PROD ? !data.isDraft && !data.isLimited : true;
});

const routes = new AllowedRoutes(Astro.url.pathname);
const { meta } = routes.getRootPageMeta();
---

<Base title={`${meta.name} | ${import.meta.env.APP_NAME}`} description=`${meta.description}`>
	<section class="flex flex-col">
		<section
			class="index-gradient py-24 px-16 2xl:pr-24 w-[calc(100%+2rem)] sm:w-[calc(100%+12rem)] lg:w-[calc(100%+8rem)] mx-[-1rem] sm:mx-[-6rem] lg:mx-[-4rem]"
		>
			<div class="flex flex-col lg:flex-row justify-center mx-auto items-center gap-16">
				<div class="flex flex-col">
					<div class="flex flex-col">
						<div class="mx-auto flex flex-col">
							<span
								class="font-semibold text-[1.25rem] lg:text-[2rem] xl:text-[2.5rem] mb-[-0.625rem] lg:mb-[-1.5rem]"
								>Hello, I'm</span
							>
							<span
								class="text-metalic-light dark:text-metalic-dark font-extrabold text-[3rem] lg:text-[4rem] xl:text-[6rem] whitespace-nowrap"
							>
								{import.meta.env.APP_OWNER}
							</span>
						</div>
						<span class="text-xs lg:text-sm xl:text-lg">
							{import.meta.env.APP_OWNER_ROLE}
						</span>
					</div>
					<ul class="flex flex-col lg:flex-row items-center gap-4 mt-8">
						<ul class="flex items-center gap-4">
							<li>
								<a
									href="/blog/1"
									class="font-code font-semibold lg:text-lg xl:text-xl bg-gradient-to-r from-accent-sub-base to-accent-base rounded-xl px-[calc(1rem+2px)] py-[calc(0.5rem+2px)] hover:opacity-50 transition duration-200"
								>
									$ ls blog
								</a>
							</li>
							<li>
								<a
									href="/about"
									class="font-code font-semibold lg:text-lg xl:text-xl border-2 border-foreground rounded-xl px-4 py-2 hover:bg-foreground hover:text-background transition duration-200"
								>
									$ whoami
								</a>
							</li>
						</ul>
						<ul class="flex items-center gap-6 mt-4 lg:mt-0 lg:ml-6">
							<li>
								<a
									href={import.meta.env.ZENN_URL}
									target="_blank"
									rel="noopener noreferrer"
									class="text-xl lg:text-2xl xl:text-3xl text-foreground hover:opacity-70 transition duration-150"
								>
									<SiZenn />
								</a>
							</li>
							<li>
								<a
									href={import.meta.env.X_URL}
									target="_blank"
									rel="noopener noreferrer"
									class="text-xl lg:text-2xl xl:text-3xl text-foreground hover:opacity-70 transition duration-150"
								>
									<SiTwitter />
								</a>
							</li>
							<li>
								<a
									href={import.meta.env.GITHUB_URL}
									target="_blank"
									rel="noopener noreferrer"
									class="text-xl lg:text-2xl xl:text-3xl text-foreground hover:opacity-70 transition duration-150"
								>
									<SiGithub />
								</a>
							</li>
							<li>
								<a
									href="/rss.xml"
									target="_blank"
									rel="noopener noreferrer"
									class="text-xl lg:text-2xl xl:text-3xl text-foreground hover:opacity-70 transition duration-150"
								>
									<IoLogoRss />
								</a>
							</li>
						</ul>
					</ul>
				</div>
			</div>
		</section>
		<section class="pt-8 w-full flex flex-col lg:flex-row">
			<article class="min-h-[calc(100dvh-8rem)] sm:min-h-0 flex flex-col gap-8 lg:w-[65%]">
				<div class="text-center lg:text-left text-3xl xl:text-5xl xl:mb-4 font-bold">
					Latest Articles
				</div>
				<ArticleCardsPanel
					articles={articles
						.sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
						.slice(0, 5)}
				/>
			</article>
			<aside
				class="pt-16 lg:pt-0 flex flex-col gap-8 lg:w-[35%] lg:pl-[3.95rem] 2xl:pl-[5.925rem] 2xl:pr-[1.975rem]"
			>
				<div class="lg:sticky lg:top-8 flex flex-col sm:gap-8">
					<CategoriesPanel client:visible />
					<TagCardsPanel client:visible />
				</div>
			</aside>
		</section>
	</section>
</Base>
